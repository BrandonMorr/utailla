<?php
/**
 * @file
 * Main hooks.
 */

// Objects.
define('UTAILLA_COLLECTION', 'ailla:collection_collection');
define('UTAILLA_ORG_COLLECTION', 'ailla:organization_collection');
define('UTAILLA_ORG_CMODEL', 'ailla:organizationCModel');
// Migrations.
define('UTAILLA_USER_MIGRATION', 'UtaillaUser');

/**
 * Implements hook_islandora_required_objects().
 */
function utailla_islandora_required_objects(IslandoraTuque $connection) {
  module_load_include('inc', 'utailla', 'includes/utilities');
  $module_path = drupal_get_path('module', 'utailla');

  // Language content model.
  $language_cmodel = $connection->repository->constructObject('ailla:languageCModel');
  $language_cmodel->owner = 'fedoraAdmin';
  $language_cmodel->label = 'Ailla Language Content Model';
  $language_cmodel->models = 'fedora-system:ContentModel-3.0';
  utailla_set_ds_composite($language_cmodel, 'language_composite_model.xml');

  // Language collection.
  $language_collection = $connection->repository->constructObject('ailla:language_collection');
  $language_collection->owner = 'fedoraAdmin';
  $language_collection->label = 'Language Collection';
  $language_collection->models = 'islandora:collectionCModel';
  $language_collection->relationships->add(FEDORA_RELS_EXT_URI, 'isMemberOfCollection', 'islandora:root');
  utailla_set_collection_policy($language_collection, 'language_collection_policy.xml');
  utailla_set_default_thumb($language_collection);

  // Country content model.
  $country_cmodel = $connection->repository->constructObject('ailla:countryCModel');
  $country_cmodel->owner = 'fedoraAdmin';
  $country_cmodel->label = 'Ailla Country Content Model';
  $country_cmodel->models = 'fedora-system:ContentModel-3.0';
  utailla_set_ds_composite($country_cmodel, 'country_composite_model.xml');

  // Country collection.
  $country_collection = $connection->repository->constructObject('ailla:country_collection');
  $country_collection->owner = 'fedoraAdmin';
  $country_collection->label = 'Country Collection';
  $country_collection->models = 'islandora:collectionCModel';
  $country_collection->relationships->add(FEDORA_RELS_EXT_URI, 'isMemberOfCollection', 'islandora:root');
  utailla_set_collection_policy($country_collection, 'country_collection_policy.xml');
  utailla_set_default_thumb($country_collection);

  // Collection collection.
  $collection_collection = $connection->repository->constructObject(UTAILLA_COLLECTION);
  $collection_collection->owner = 'fedoraAdmin';
  $collection_collection->label = 'Collections';
  $collection_collection->models = 'islandora:collectionCModel';
  $collection_collection->relationships->add(FEDORA_RELS_EXT_URI, 'isMemberOfCollection', 'islandora:root');
  utailla_set_collection_policy($collection_collection, 'collection_collection_policy.xml');

  // Organization collection.
  $org_collection = $connection->repository->constructObject(UTAILLA_ORG_COLLECTION);
  $org_collection->owner = 'fedoraAdmin';
  $org_collection->label = 'Organizations';
  $org_collection->models = 'islandora:collectionCModel';
  $org_collection->relationships->add(FEDORA_RELS_EXT_URI, 'isMemberOfCollection', 'islandora:root');
  utailla_set_default_thumb($org_collection);
  utailla_set_collection_policy($org_collection, 'organization_collection_policy.xml');

  // Organization content model.
  $org_cmodel = $connection->repository->constructObject(UTAILLA_ORG_CMODEL);
  $org_cmodel->owner = 'fedoraAdmin';
  $org_cmodel->label = 'Organization Content Model';
  $org_cmodel->models = 'fedora-system:ContentModel-3.0';
  utailla_set_ds_composite($org_cmodel, 'organization_composite_model.xml');

  return array(
    'utailla' => array(
      'title' => t('AILLA'),
      'objects' => array(
        $language_cmodel,
        $language_collection,
        $country_cmodel,
        $country_collection,
        $org_collection,
        $org_cmodel,
        $collection_collection,
      ),
    ),
  );
}
